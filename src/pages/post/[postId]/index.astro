---
import { ViewerComponent } from "@/components/Viewer";
import { db } from "@/db";
import { getPostContent } from "@/db/queries";
import Layout from "@/layouts/Layout.astro";
import type { Block } from "@blocknote/core";
import "@blocknote/core/fonts/inter.css";
import "@blocknote/mantine/style.css";

const { postId } = Astro.params;

if (!postId) {
  return Astro.redirect("/");
}

const post = await getPostContent.execute({ postId: postId as string });

if (!post) {
  return Astro.redirect("/404");
}
---

<Layout>
  <ViewerComponent client:only="react" document={post.content as Block[]} />
</Layout>
